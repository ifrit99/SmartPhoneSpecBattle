# コーディング規約とルール

## 命名規則
- **ファイル名・ディレクトリ名**: スネークケース (`snake_case.dart`)。プレフィックスやサフィックスに型を含めない。
- **クラス名**: パスカルケース (`PascalCase`)。Widgetクラス、モデルクラス、サービスクラスなど全て適用。
- **変数名・メソッド名**: キャメルケース (`camelCase`)。
  - プライベートな変数/メソッドには必ずアンダースコア `_` をプレフィックスとして付ける。
  - bool型の変数は `isSomething`, `hasSomething` のような形式を推奨。
- **定数名**: キャメルケース（`const int maxHp = 100`）または大文字スネークケース（`static const MAX_TURNS = 50`）。一貫性を持たせる。

## 型指定とNull安全 (Null Safety)
- **Dart 3.x / Null Safety**: 完全に準拠。
  - `late` キーワードは初期化が確約されている場合のみ使用（例: `AnimationController`の`initState`での初期化）。
  - Null許容型（`Type?`）は必要最小限にし、極力デフォルト値を与えるか`required`で縛る。
- **型推論 (`var`, `final`)**:
  - ローカル変数は基本的に `final` を使用して不変（Immutable）性を高める。
  - 再代入が必要な場合のみ `var` や型明示による変数宣言を使用。
  - 右辺から型が自明な場合は `final` を使い、型名 `final String name = ...` と二重に書かない傾向がある。

## コード構造のルール
- **モデルのイミュータブル化**: `Character`や`Stats`などのドメインモデルは、基本的に状態を直接変更せず、`copyWith`メソッドや専用のコピーメソッド（`withHp`など）を使って新しいインスタンスを生成して返す設計とする。
- **コメント**: 処理内容や意図がわかるように、関数ドキュメントコメント（`///`）およびインラインコメント（`//`）を**日本語**で記述する。
- **条件付きインポート**: プラットフォーム依存のコード（例: `dart:io` を使うネイティブAPIに対する、Web用のスタブ）は、`if (dart.library.io)` を用いた条件付きエクスポート/インポートパターンを利用し、呼び出し側をクリーンに保つ。

## Widgetの実装ルール
- **constコンストラクタ**: パフォーマンス最適化のため、状態を持たないWidgetツリーや固定の値には可能な限り `const` キーワードを付与する。
  - `flutter analyze` で警告が出ないように徹底する。
- **UIとロジックの分離**: `build`メソッド内に複雑なビジネスロジックを含めない。計算処理はドメイン層のServiceに寄せるか、事前に計算した値を使用する。
